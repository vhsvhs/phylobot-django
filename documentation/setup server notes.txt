#
# How to setup a PhyloBot server on EC2
#

Instructions:

1a. In the AWS console, launch an instance from the AMI 'ami-33bc5877'.
1b. After the instance is running, find its public IP address (usually found in the Description tab).

2a. Login into the server:
	$> ssh -i ~/.ssh/phylobot-ec2-key.pem ubuntu@PUBLICIP
		. . .where PUBLICIP is the IP address of the instance launched in #1.

2b. Update PhyloBot:
	# PhyloBot is already installed in the AMI, so we simply need to update
	# the git repo with the latest code.
	$> cd phylbot-django
	$> sudo git pull
	$> cd ~/
	$> sudo bash phylobot-django/aws_setup/setup_phylobot_server_on_aws.sh

2c. Answer the question to create a superuser for the Django portal.

3. Copy a .boto file to the server. Do the following on your local machine (not on the remote PhyloBot):
	$> cd ~/
	$> scp -i ~/.ssh/phylobot-ec2-key.pem ~/.boto ubuntu@PUBLICIP:~/
	
3b. Copy the PhyloBot key onto the new server. (Do this from your local machine).
	$> scp -i ~/.ssh/phylobot-ec2-key.pem ~/.ssh/phylobot-ec2-key.pem ubuntu@54.183.185.164:~/.ssh/
	
4. Launch the Job Daemon (using the terminal logged into the server)
	$> screen
	$> 

4. If no errors were reported, PhyloBot should be running at the PUBLICIP.

5. Optional: If you're cloning PhyloBot from another instance, then run the 
	migration script to copy all the static data, databases, and BOTO configurations.
	$> sudo bash aws_setup/migrate.sh
	
6. Restart Apache.
	$> sudo service apache2 restart
	
7. Done!